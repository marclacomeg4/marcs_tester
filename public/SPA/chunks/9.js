(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"B+xg":function(t,e,a){"use strict";a.r(e);var i=a("XRms"),s=a("hZR/"),n=a("DAy3"),r=a("buV7"),l=a("0SPX"),o=a("k0eF"),d=a("JORO"),c=a("0p8l"),u=a("HXgr"),p=a("Wmi+"),f=a("xcCE"),g={name:"calls-dialog",components:{UserChip:p.a,CustomerChip:d.a,ContractStatusChip:o.a,BrandFab:l.a,ContractTypeChip:r.a,AffinitySiteChip:c.a,AffinityTeamChip:f.a},template:"contract-dialog",mixins:[u.a],props:{display_dialog:{required:!0},init_query:{required:!0}},data:function(){return{default_query:{endpoint:"telesales_opportunities",fields:["id"],relations:{residentialLead:{fields:["uid"],relations:{residentialPartner:{fields:["name"]},residentialSubPartner:{fields:["name"]}}}},order_by:[{field:"CREATED_AT",order:"DESC"}]},columns:[{text:"Partner",value:"residentialLead.residentialPartner"},{text:"Sub Partner",value:"residentialLead.residentialSubPartner"}]}}},_=a("KHd+"),m=Object(_.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.display_dialog,callback:function(e){t.display_dialog=e},expression:"display_dialog"}},[a("v-card",[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-toolbar-title",[t._v("Calls Drilldown")]),t._v(" "),a("v-spacer"),t._v(" "),a("v-toolbar-items",[a("v-btn",{attrs:{fab:""},on:{click:t.download}},[a("v-icon",[t._v("cloud_download")])],1),t._v(" "),a("v-btn",{attrs:{fab:""},on:{click:function(e){return t.$emit("closeContractDrilldown")}}},[a("v-icon",[t._v("close")])],1)],1)],1),t._v(" "),a("v-card-text",{staticClass:"mt-4"},[a("v-row",[a("v-col",[a("v-data-table",{attrs:{headers:t.displayColumns,items:t.rows,options:t.options,loading:t.loading,"footer-props":{"items-per-page-options":[25,50,100,250]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item;return[a("tr",[a("td",{staticClass:"pa-0 stat-td"},[t._v("\n                                    "+t._s(i.residentialLead.residentialPartner?i.residentialLead.residentialPartner.name:"")+"\n                            ")]),t._v(" "),a("td",{staticClass:"pa-0 stat-td"},[t._v("\n                                "+t._s(i.residentialLead.residentialSubPartner?i.residentialLead.residentialSubPartner.name:"")+"\n                            ")])])]}}])})],1)],1)],1)],1)],1)}),[],!1,null,"747dd3db",null).exports,v={name:"calls-wallboard-widget",components:{StatTableCell:i.a,StatUserTableCell:s.a,CallsDialog:m},data:function(){return{statistics:[],loading:!1,dialog:!1,tableOptions:{itemsPerPage:15},footerProps:{itemsPerPageOptions:[15,20,25,-1]},query:{params:{}},columns:[{text:"Brand",value:"brand",class:"tabhead",onclick:{}},{text:"Outstanding",value:"opportunitiesOutstanding",class:"tabhead",onclick:{}},{text:"Completed",value:"opportunitiesCompleted",class:"tabhead",onclick:{payload:"broadband"}},{text:"Callbacks",value:"opportunitiesCallbacksOutstanding",class:"tabhead"},{text:"Actions?",value:"opportunitiesActions",class:"tabhead"}]}},mixins:[n.a],methods:{getStatistics:function(){var t=this;this.loading=!0;var e={endpoint:"telesales_opportunities_statistics",fields:["stats"],params:{created_between:this.$store.getters["date_range/date_range"]},relations:{}};this.$graph.getEndPointQuery(e).then((function(e){console.log("get statistics "+JSON.stringify(e)),t.statistics=Object.values(e.stats)})).catch((function(t){console.log(t)})).finally((function(){t.loading=!1}))},requestDrilldown:function(t,e){this.query.params={},this.query.params.created_between=this.$store.getters["date_range/date_range"],this.dialog=!0,console.log("REQUEST DRILLDOWN!!! "+JSON.stringify(e))}},created:function(){this.getStatistics()}},b={name:"calls-wall-board",components:{WallboardWidget:Object(_.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("stat-panel",{attrs:{loading:t.loading}},[a("calls-dialog",{attrs:{display_dialog:t.dialog,init_query:t.query},on:{closeContractDrilldown:function(e){t.dialog=!1}}}),t._v(" "),a("v-data-table",{attrs:{headers:t.columns,items:t.statistics,options:t.tableOptions,"footer-props":t.footerProps},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item;return[a("tr",t._l(t.columns,(function(e){return a("td",{staticClass:"pa-0 stat-td",on:{click:function(a){return a.preventDefault(),t.requestDrilldown(i.attributed_to_user_id,e.onclick)}}},[a("stat-table-cell",{attrs:{user_id:i.user_id}},[t._v("\n                    "+t._s(i[e.value])+"\n                ")])],1)})),0)]}}])})],1)}),[],!1,null,"9ae8dfe6",null).exports},data:function(){return{statistics:[],loading:!1,dialog:!1,tableOptions:{itemsPerPage:15},footerProps:{itemsPerPageOptions:[15,20,25,-1]},query:{params:{}},columns:[{}]}},methods:{}},h=Object(_.a)(b,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("stat-toolbar",{attrs:{title:"Opportunities"}}),this._v(" "),e("wallboard-widget")],1)}),[],!1,null,"b4ff5668",null);e.default=h.exports},DAy3:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var i={watch:{user_id:{handler:function(){this.getStatistics()}},affinity_team_id:{handler:function(){this.getStatistics()}},dateRange:{handler:function(){this.getStatistics()},deep:!0}},computed:{dateRange:{get:function(){return this.$store.getters["date_range/date_range"]},set:function(t){return this.$store.dispatch("date_range/dateRange",t)}}}}},XRms:function(t,e,a){"use strict";var i={name:"stat-table-cell"},s=a("KHd+"),n=Object(s.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-card",{attrs:{rounded:"0"}},[e("v-card-title",{staticStyle:{"font-size":"35px","white-space":"nowrap"}},[this._t("default")],2)],1)}),[],!1,null,"2dfab402",null);e.a=n.exports},"hZR/":function(t,e,a){"use strict";var i={name:"stat-user-table-cell",props:{user_id:{default:null}}},s=a("KHd+"),n=Object(s.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-card",{attrs:{flat:""}},[e("div",{staticStyle:{"margin-left":"10px"}},[e("v-avatar",{attrs:{left:""}},[e("v-img",{attrs:{src:"https://admin.global4.co.uk/img/users/thumbnail/"+this.user_id+".jpg"}})],1),this._v("\n    Â "),e("span",{staticStyle:{"font-size":"20px"}},[this._t("default")],2)],1)])}),[],!1,null,"3c29cbf1",null);e.a=n.exports}}]);