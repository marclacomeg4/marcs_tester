(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{a2bP:function(e,t,n){"use strict";function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s={name:"CampaignSelector",props:{selectAllCampaigns:{type:Boolean,required:!0},campaign_uid:{required:!0}},data:function(){return{campaigns:[],loading:!1,select_campaign_on_load:null}},methods:{listCampaigns:function(){var e=this;this.loading=!0;var t={fields:["uid","name"],endpoint:"marketing_campaign_names"};graph.getEndPointQuery(t).then((function(t){console.log(t),e.campaigns=i(t),e.selectAllCampaigns&&e.campaigns.unshift({uid:null,name:"All"}),e.loading=!1,e.$route.params.hasOwnProperty("campaign_uid")&&e.$emit("update:campaign_uid",e.$route.params.campaign_uid),e.select_campaign_on_load&&(e.$emit("update:campaign_uid",e.select_campaign_on_load),e.select_campaign_on_load=null)})).catch((function(e){console.log("GET campaigns ERROR:",e)})).finally((function(){}))}},created:function(){var e=this;this.listCampaigns(),this.$bus.on("reload_campaigns_and_select",(function(t){console.log("force reload "+t),e.select_campaign_on_load=t,e.listCampaigns()}))},beforeDestroy:function(){this.$bus.$off("reload_campaigns_and_select")}},o=n("KHd+"),r=Object(o.a)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[e.loading?e._e():n("v-select",{attrs:{items:e.campaigns,label:"Select a Campaign","item-text":"name","item-value":"uid",outlined:"",value:e.campaign_uid},on:{input:function(t){return e.$emit("update:campaign_uid",t)}}}),e._v(" "),e.loading?n("v-progress-circular",{attrs:{indeterminate:""}}):e._e()],1)}),[],!1,null,"14a74f8d",null);t.a=r.exports},kiv0:function(e,t,n){"use strict";n.r(t);var i=n("L2JU"),a=n("MS4I"),s=n("a2bP");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={components:{InformUser:a.a,CampaignSelector:s.a},data:function(){return{date_day_input:1,date_month_input:3,date_year_input:2021,telesales_opportunity_criteria_id:30,campaign_selector:{campaign_uid:null},create_leads_count:100,response:"",criterias:[],selected_criteria:null,purge_monitor_days_input:0,delete_mode:null,delete_confirm:null,reset_sms:!1,reset_email:!1,headers:[{text:"to",value:"to"},{text:"name",value:"name"},{text:"started",value:"started"},{text:"completed",value:"completed"},{text:"status",value:"status"},{text:"template",value:"marketing_campaign_schedule_action.template"},{text:"sms",value:"marketing_campaign_schedule_action.sms"}],monitor_items:[]}},mixins:[],methods:{addScheduledActionsToCampaign:function(){this.campaign_selector.campaign_uid?(console.log(this.selected_criteria),this.$store.dispatch("email/add_scheduled_actions_to_campaign",{telesales_opportunity_criteria_id:this.selected_criteria,campaign_uid:this.campaign_selector.campaign_uid})):this.$store.commit("inform_user/show_inform_message","You must select a campaign")},transmitCampaignEmail:function(){var e=this.date_year_input+"-"+this.date_month_input+"-"+this.date_day_input+" 00:00:00";this.$store.dispatch("email/transmit_campaign_emails",{date:e,campaign_uid:this.campaign_selector.campaign_uid?his.campaign_selector.campaign_uid:"*"})},transmitEverything:function(){var e=this.date_year_input+"-"+this.date_month_input+"-"+this.date_day_input+" 00:00:00";this.$store.dispatch("email/transmit_all_by_day",e)},transmitCampaignSMS:function(){var e=this.date_year_input+"-"+this.date_month_input+"-"+this.date_day_input+" 00:00:00";this.$store.dispatch("email/transmit_campaign_sms",{date:e,campaign_uid:this.campaign_selector.campaign_uid?his.campaign_selector.campaign_uid:"*"})},editLeadTargetDate:function(){var e=this;axios.post("/marketing-api/edit-lead-target-date",{residential_lead_uid:"c2e6ec63-4ff8-4ac9-b2ea-9f8463b85063"}).then((function(t){console.log(t),e.response=t}))},getOpportunityCriterias:function(){var e=this;graph.getEndPointQuery({endpoint:"telesales_opportunity_criterias",fields:["id","name"],paginate:{first:1e3},params:{first:1e3}}).then((function(t){console.log("Get telesales_opportunity:",t),e.criterias=t.data})).catch((function(e){console.log("GET telesales_opportunity ERROR:",e)}))},createTestLeads:function(){var e=this;axios.post("marketing-api/create-test-leads",{total:this.create_leads_count}).then((function(t){console.log("create-test-leads "+JSON.stringify(t.data)),e.response=JSON.stringify(t.data)}))},clearCampaignMonitor:function(){var e=this;axios.post("marketing-api/purge-monitor",{days:this.purge_monitor_days_input}).then((function(t){console.log("purge monitor "+JSON.stringify(t.data)),e.response=JSON.stringify(t.data)}))},getCampaignMonitor:function(){var e=this,t=this.date_year_input+"-"+this.date_month_input+"-"+this.date_day_input+" 00:00:00";axios.post("marketing-api/get-monitor",{from:t,to:t}).then((function(t){e.monitor_items=t.data}))},transmitTestSMS:function(){var e=this;axios.post("marketing-api/test-transmit-sms",{number:this.test_sms_number}).then((function(t){console.log("test transmit sms "+JSON.stringify(t.data)),e.response=JSON.stringify(t.data)}))},resetScheduleActionStatus:function(e){var t=this,n={date:this.date_year_input+"-"+this.date_month_input+"-"+this.date_day_input+" 00:00:00",sms:this.reset_sms,email:this.reset_email};axios.post("marketing-api/reset-schedule-action-status",n).then((function(e){console.log("reset schedule action status "+JSON.stringify(e.data)),t.response=JSON.stringify(e.data)}))},testFunc:function(){var e=this;axios.post("marketing-api/test-func").then((function(t){console.log("test func "+JSON.stringify(t.data)),e.response=JSON.stringify(t.data)}))},requestDelete:function(e){this.delete_mode=e},confirmDelete:function(){if("123456"==this.delete_confirm)switch(this.delete_mode=null,this.delete_mode){case"ALL":this.deleteTestData();break;case"SCHEDULES":this.deleteSchedules();break;case"ACTIONS":this.deleteScheduledActions()}},cancelDelete:function(){this.delete_mode=null},deleteTestData:function(){var e=this;axios.post("/marketing-api/delete-test-data").then((function(t){console.log("delete-test-data response "+JSON.stringify(t.data)),e.response="delete-test-data response "+JSON.stringify(t.data)})).catch((function(e){console.log(e)}))},deleteScheduledActions:function(){var e=this;axios.post("/marketing-api/delete-scheduled-actions").then((function(t){console.log("delete-scheduled-actions "+JSON.stringify(t.data)),e.response="delete-scheduled-actions "+JSON.stringify(t.data)})).catch((function(e){console.log(e)}))},deleteSchedules:function(){var e=this;axios.post("/marketing-api/delete-schedules").then((function(t){console.log("delete-schedules "+JSON.stringify(t.data)),e.responses="delete-schedules "+JSON.stringify(t.data)})).catch((function(e){console.log(e)}))}},computed:r(r(r({},Object(i.b)("email",["live_mode"])),Object(i.b)("user",["user"])),{},{test_sms_number:function(){return this.live_mode?this.live_mode.test_sms:null},user_is_marc:function(){return-1!==this.user.email.indexOf("marc.lacome")}}),created:function(){this.getOpportunityCriterias()}},u=n("KHd+"),d=Object(u.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.user_is_marc?n("span",[n("v-row",[n("v-col",[n("v-dialog",{attrs:{"max-width":"50%"},model:{value:e.delete_mode,callback:function(t){e.delete_mode=t},expression:"delete_mode"}},[n("v-card",[e._v("\n            Enter the confirmation code\n            "),n("v-text-field",{attrs:{outlined:""},model:{value:e.delete_confirm,callback:function(t){e.delete_confirm=t},expression:"delete_confirm"}}),e._v(" "),n("v-divider"),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.confirmDelete}},[e._v("\n        Yes\n      ")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.cancelDelete}},[e._v("\n        No\n      ")])],1)],1)],1)],1)],1),e._v(" "),n("v-row",[n("v-col",{staticClass:"pt-0"},[n("v-toolbar",{attrs:{dark:"",dense:"",color:"primary"}},[n("v-toolbar-title",[e._v("\n                DEVELOPER\n            ")]),e._v(" "),n("DemoDisplay")],1)],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("div",{attrs:{id:"responses"}},[e._v(e._s(e.response))])]),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("h4",[e._v("FOR DEVELOPMENT ONLY!")]),e._v(" "),n("ul",[n("li"),e._v(" "),n("li",[n("v-expansion-panels",[n("v-expansion-panel",[n("v-expansion-panel-header",[e._v("\n                            DELETE ALL\n                        ")]),e._v(" "),n("v-expansion-panel-content",[n("v-btn",{on:{click:function(t){return e.requestDeleteT("ALL")}}},[e._v("Delete all test data")]),e._v(" "),n("p"),e._v(" "),n("v-btn",{on:{click:function(t){return e.requestDelete("SCHEDULES")}}},[e._v("Delete Schedules")])],1)],1)],1)],1),e._v(" "),n("li"),e._v(" "),n("li"),e._v(" "),n("li",[n("v-btn",{on:{click:function(t){return e.requestDelete("Actions")}}},[e._v("Delete Scheduled Actions")])],1),e._v(" "),n("li",[n("ul",[n("li",[n("CampaignSelector",e._b({attrs:{selectAllCampaigns:!0}},"CampaignSelector",e.campaign_selector,!1,!0))],1),e._v(" "),n("li",[n("v-select",{attrs:{items:e.criterias,outlined:"","item-text":"name","item-value":"id",label:"Opportunity Criteria"},model:{value:e.selected_criteria,callback:function(t){e.selected_criteria=t},expression:"selected_criteria"}})],1)]),e._v(" "),n("v-btn",{on:{click:e.addScheduledActionsToCampaign}},[e._v("Add Scheduled Actions")])],1)])]),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("ul",[n("li",[e._v("\n                Day\n                "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.date_day_input,expression:"date_day_input"}],attrs:{"single-line":"","hide-details":"","show-select":"",type:"number"},domProps:{value:e.date_day_input},on:{input:function(t){t.target.composing||(e.date_day_input=t.target.value)}}}),e._v("\n                Month\n                "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.date_month_input,expression:"date_month_input"}],attrs:{"single-line":"","hide-details":"","show-select":"",type:"number"},domProps:{value:e.date_month_input},on:{input:function(t){t.target.composing||(e.date_month_input=t.target.value)}}}),e._v("\n                year\n                "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.date_year_input,expression:"date_year_input"}],attrs:{"single-line":"","hide-details":"","show-select":"",type:"number"},domProps:{value:e.date_year_input},on:{input:function(t){t.target.composing||(e.date_year_input=t.target.value)}}})]),n("li"),e._v(" "),n("li",[n("v-btn",{on:{click:e.transmitEverything}},[e._v("Transmit Everything")])],1),e._v(" "),n("li"),e._v(" "),n("li"),e._v(" "),n("li",[n("v-btn",{on:{click:e.transmitCampaignEmail}},[e._v("Transmit Emails By Day")])],1),e._v(" "),n("li"),e._v(" "),n("v-btn",{on:{click:e.transmitCampaignSMS}},[e._v("Transmit SMS By Day")]),e._v(" "),n("li"),e._v(" "),n("li"),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.test_sms_number,expression:"test_sms_number"}],attrs:{"single-line":"","hide-details":"","show-select":""},domProps:{value:e.test_sms_number},on:{input:function(t){t.target.composing||(e.test_sms_number=t.target.value)}}}),e._v(" "),n("li"),e._v(" "),n("li"),e._v(" "),n("v-btn",{on:{click:e.transmitTestSMS}},[e._v("Transmit Test SMS")]),e._v(" "),n("li")],1)]),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("ul",[n("li"),e._v(" "),n("li"),e._v(" "),n("li",[n("v-text-field",{attrs:{type:"number",outlined:""},model:{value:e.create_leads_count,callback:function(t){e.create_leads_count=t},expression:"create_leads_count"}})],1),e._v(" "),n("li",[n("v-btn",{on:{click:e.createTestLeads}},[e._v("Create Test Leads")])],1),e._v(" "),n("li"),e._v(" "),n("li",[e._v("\n                Clear older than (days)\n                "),n("v-text-field",{attrs:{type:"number",outlined:""},model:{value:e.purge_monitor_days_input,callback:function(t){e.purge_monitor_days_input=t},expression:"purge_monitor_days_input"}})],1),e._v(" "),n("v-btn",{on:{click:e.clearCampaignMonitor}},[e._v("Clear Monitor")]),e._v(" "),n("li"),e._v("\n            Clear by d/m/year - set in col 2\n            "),n("li"),e._v(" "),n("v-switch",{attrs:{label:"email"},model:{value:e.reset_email,callback:function(t){e.reset_email=t},expression:"reset_email"}}),e._v(" "),n("v-switch",{attrs:{label:"sms"},model:{value:e.reset_sms,callback:function(t){e.reset_sms=t},expression:"reset_sms"}}),e._v(" "),n("v-btn",{on:{click:e.resetScheduleActionStatus}},[e._v("Reset TX Status")]),e._v(" "),n("li"),e._v(" "),n("li",[n("v-btn",{on:{click:e.testFunc}},[e._v("test func")])],1),e._v(" "),n("li")],1)])],1),e._v(" "),n("v-row",[n("v-col",[e._v("\n            Get by d/m/year - set in col 2\n            "),n("v-btn",{on:{click:e.getCampaignMonitor}},[e._v("Get Monitor")]),e._v(" "),n("v-data-table",{attrs:{headers:e.headers,items:e.monitor_items,"disable-pagination":!0,"hide-default-footer":!0,"disable-sort":!0,"item-key":"uid"}})],1)],1)],1):e._e()}),[],!1,null,null,null);t.default=d.exports}}]);